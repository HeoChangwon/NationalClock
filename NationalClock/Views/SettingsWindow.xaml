<Window x:Class="NationalClock.Views.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:NationalClock.Views"
        xmlns:converters="clr-namespace:NationalClock"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        mc:Ignorable="d"
        Title="Settings - National Clock" 
        Height="700" Width="900" MinHeight="600" MinWidth="800"
        Background="{DynamicResource MaterialDesignPaper}"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        TextElement.FontWeight="Regular"
        TextElement.FontSize="13"
        TextOptions.TextFormattingMode="Ideal"
        TextOptions.TextRenderingMode="Auto"
        FontFamily="{DynamicResource MaterialDesignFont}"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        ShowInTaskbar="False">
    
    <Window.Resources>
        <!-- Timezone Item Template -->
        <DataTemplate x:Key="TimeZoneItemTemplate">
            <Border Padding="8,4" Margin="2" 
                  Background="Transparent"
                  BorderBrush="{DynamicResource MaterialDesignDivider}"
                  BorderThickness="0,0,0,1">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Flag -->
                    <TextBlock Grid.Column="0" 
                             Text="{Binding FlagEmoji}" 
                             FontSize="16" 
                             Margin="0,0,8,0" 
                             VerticalAlignment="Center"/>
                    
                    <!-- Display Name -->
                    <TextBlock Grid.Column="1" 
                             Text="{Binding DisplayName}" 
                             VerticalAlignment="Center"/>
                    
                    <!-- Timezone ID -->
                    <TextBlock Grid.Column="2" 
                             Text="{Binding TimeZoneId}" 
                             Foreground="{DynamicResource MaterialDesignBodyLight}"
                             VerticalAlignment="Center"/>
                </Grid>
            </Border>
        </DataTemplate>

        <!-- Value Converters -->
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <converters:InverseBooleanConverter x:Key="InverseBooleanConverter"/>
    </Window.Resources>

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <materialDesign:Card Grid.Row="0" Padding="16" Margin="0,0,0,16"
                           materialDesign:ElevationAssist.Elevation="Dp1"
                           Background="{DynamicResource PrimaryHueMidBrush}">
            <StackPanel Orientation="Horizontal">
                <materialDesign:PackIcon Kind="Settings" 
                                       Foreground="{DynamicResource PrimaryHueDarkForegroundBrush}"
                                       Width="32" Height="32" 
                                       VerticalAlignment="Center"
                                       Margin="0,0,12,0"/>
                <TextBlock Text="National Clock Settings" 
                         FontSize="20" FontWeight="Medium"
                         Foreground="{DynamicResource PrimaryHueDarkForegroundBrush}"
                         VerticalAlignment="Center"/>
            </StackPanel>
        </materialDesign:Card>

        <!-- Settings Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Left Panel - General Settings -->
                <StackPanel Grid.Column="0" Margin="0,0,8,0">
                    
                    <!-- Time Format Settings -->
                    <materialDesign:Card Padding="16" Margin="0,0,0,16">
                        <StackPanel>
                            <TextBlock Text="Time Format" 
                                     FontSize="16" FontWeight="Medium"
                                     Margin="0,0,0,12"/>
                            
                            <RadioButton Content="12-Hour Format (AM/PM)" 
                                       IsChecked="{Binding Is24HourFormat, Converter={StaticResource InverseBooleanConverter}}"
                                                                              Margin="0,4"/>
                            
                            <RadioButton Content="24-Hour Format" 
                                       IsChecked="{Binding Is24HourFormat}"
                                                                              Margin="0,4"/>
                        </StackPanel>
                    </materialDesign:Card>

                    <!-- Theme Settings -->
                    <materialDesign:Card Padding="16" Margin="0,0,0,16">
                        <StackPanel>
                            <TextBlock Text="Appearance" 
                                     FontSize="16" FontWeight="Medium"
                                     Margin="0,0,0,12"/>
                            
                            <ToggleButton IsChecked="{Binding IsDarkMode}"
                                        Content="Dark Mode"
                                        Margin="0,8"/>
                            
                            <ComboBox materialDesign:HintAssist.Hint="Accent Color"
                                    ItemsSource="{Binding AccentColorNames}"
                                    SelectedItem="{Binding SelectedAccentColor}"
                                    Margin="0,8"/>
                            
                            <Button Content="Preview Theme" 
                                    Command="{Binding PreviewThemeCommand}"
                                    Margin="0,8"/>
                        </StackPanel>
                    </materialDesign:Card>

                    <!-- Window Options -->
                    <materialDesign:Card Padding="16" Margin="0,0,0,16">
                        <StackPanel>
                            <TextBlock Text="Window Options" 
                                     FontSize="16" FontWeight="Medium"
                                     Margin="0,0,0,12"/>
                            
                            <ToggleButton IsChecked="{Binding IsAlwaysOnTop}"
                                        Content="Always On Top"
                                        Margin="0,8"/>
                            
                            <ToggleButton IsChecked="{Binding ShowSeconds}"
                                        Content="Show Seconds"
                                        Margin="0,8"/>
                            
                            <ToggleButton IsChecked="{Binding ShowDate}"
                                        Content="Show Date"
                                        Margin="0,8"/>
                            
                            <ToggleButton IsChecked="{Binding ShowTimeZoneOffset}"
                                        Content="Show Timezone Offset"
                                        Margin="0,8"/>
                            
                            <ToggleButton IsChecked="{Binding IsCompactMode}"
                                        Content="Compact Mode"
                                        Margin="0,8"/>
                        </StackPanel>
                    </materialDesign:Card>

                    <!-- System Options -->
                    <materialDesign:Card Padding="16">
                        <StackPanel>
                            <TextBlock Text="System Options" 
                                     FontSize="16" FontWeight="Medium"
                                     Margin="0,0,0,12"/>
                            
                            <ToggleButton IsChecked="{Binding AutoStartWithWindows}"
                                        Content="Start with Windows"
                                        Margin="0,8"/>
                            
                            <StackPanel Orientation="Horizontal" Margin="0,8">
                                <TextBlock Text="Update Interval:" 
                                         VerticalAlignment="Center"
                                         Margin="0,0,8,0"/>
                                <Slider Value="{Binding UpdateIntervalSeconds}"
                                      Minimum="1" Maximum="60"
                                      Width="150"
                                      VerticalAlignment="Center"/>
                                <TextBlock Text="{Binding UpdateIntervalSeconds, StringFormat={}{0}s}" 
                                         VerticalAlignment="Center"
                                         Margin="8,0,0,0"/>
                            </StackPanel>
                        </StackPanel>
                    </materialDesign:Card>
                </StackPanel>

                <!-- Right Panel - Timezone Management -->
                <StackPanel Grid.Column="1" Margin="8,0,0,0">
                    
                    <!-- Timezone Selection -->
                    <materialDesign:Card Padding="16">
                        <StackPanel>
                            <TextBlock Text="Timezone Management" 
                                     FontSize="16" FontWeight="Medium"
                                     Margin="0,0,0,12"/>

                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="200"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="200"/>
                                </Grid.RowDefinitions>

                                <!-- Available Timezones -->
                                <TextBlock Grid.Row="0"
                                         Text="Available Timezones" 
                                         Margin="0,8"/>
                                
                                <Border Grid.Row="1" 
                                      BorderBrush="{DynamicResource MaterialDesignDivider}"
                                      BorderThickness="1"
                                      CornerRadius="4">
                                    <ListBox ItemsSource="{Binding AvailableTimeZones}"
                                           SelectedItem="{Binding SelectedAvailableTimeZone}"
                                           ItemTemplate="{StaticResource TimeZoneItemTemplate}"
                                           ScrollViewer.HorizontalScrollBarVisibility="Disabled"/>
                                </Border>

                                <!-- Control Buttons -->
                                <StackPanel Grid.Row="2" Orientation="Horizontal" 
                                          HorizontalAlignment="Center" Margin="0,16">
                                    <Button Content="Add ▼" 
                                            Command="{Binding AddTimeZoneCommand}"
                                            Margin="4"/>
                                    <Button Content="▲ Remove" 
                                            Command="{Binding RemoveTimeZoneCommand}"
                                            Margin="4"/>
                                </StackPanel>

                                <!-- Enabled Timezones -->
                                <TextBlock Grid.Row="3"
                                         Text="Enabled Timezones" 
                                         Margin="0,8"/>
                                
                                <Grid Grid.Row="4">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <!-- Enabled Timezones List -->
                                    <Border Grid.Column="0"
                                          BorderBrush="{DynamicResource MaterialDesignDivider}"
                                          BorderThickness="1"
                                          CornerRadius="4">
                                        <ListBox ItemsSource="{Binding EnabledTimeZones}"
                                               SelectedItem="{Binding SelectedEnabledTimeZone}"
                                               ItemTemplate="{StaticResource TimeZoneItemTemplate}"
                                               ScrollViewer.HorizontalScrollBarVisibility="Disabled"/>
                                    </Border>
                                    
                                    <!-- Order Control Buttons -->
                                    <StackPanel Grid.Column="1" Margin="8,0,0,0" VerticalAlignment="Center">
                                        <Button Content="{materialDesign:PackIcon Kind=ArrowUp}" 
                                                Command="{Binding MoveUpCommand}"
                                                ToolTip="Move Up"
                                                Margin="0,2"/>
                                        <Button Content="{materialDesign:PackIcon Kind=ArrowDown}" 
                                                Command="{Binding MoveDownCommand}"
                                                ToolTip="Move Down"
                                                Margin="0,2"/>
                                    </StackPanel>
                                </Grid>
                            </Grid>
                        </StackPanel>
                    </materialDesign:Card>
                </StackPanel>
            </Grid>
        </ScrollViewer>

        <!-- Action Buttons -->
        <materialDesign:Card Grid.Row="2" Padding="16" Margin="0,16,0,0"
                           materialDesign:ElevationAssist.Elevation="Dp1">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="Reset to Defaults" 
                        Command="{Binding ResetToDefaultsCommand}"
                        Margin="0,0,8,0"/>
                
                <Button Content="Cancel" 
                        Command="{Binding CancelCommand}"
                        IsCancel="True"
                        Margin="0,0,8,0"/>
                
                <Button Content="Save" 
                        Command="{Binding SaveCommand}"
                        IsDefault="True"
                        Background="{DynamicResource PrimaryHueMidBrush}"
                        BorderBrush="{DynamicResource PrimaryHueMidBrush}"/>
            </StackPanel>
        </materialDesign:Card>

        <!-- Unsaved Changes Indicator - Temporarily disabled -->
        <!--<materialDesign:Snackbar Grid.Row="0" Grid.RowSpan="3"
                               x:Name="UnsavedChangesSnackbar"
                               MessageQueue="{materialDesign:MessageQueue}"
                               Visibility="{Binding HasUnsavedChanges, Converter={StaticResource BooleanToVisibilityConverter}}"/>-->
    </Grid>
</Window>